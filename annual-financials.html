<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Big Tech 8 - 종합 재무 데이터</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0f1117;--card:#1a1d27;--card2:#222639;--border:#2d3148;--text:#e0e0e8;--text2:#9498b0;--accent:#6366f1;--accent2:#818cf8;--green:#22c55e;--red:#ef4444;--yellow:#eab308;--cyan:#06b6d4;--orange:#f97316;--pink:#ec4899}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
.top-nav{background:#13141f;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:100;backdrop-filter:blur(12px)}
.top-nav-inner{max-width:1400px;margin:0 auto;display:flex;align-items:center;padding:0 16px;gap:0;overflow-x:auto}
.nav-brand{font-size:0.82em;font-weight:800;color:var(--accent2);padding:12px 16px 12px 0;white-space:nowrap;border-right:1px solid var(--border);margin-right:4px;letter-spacing:-0.3px}
.nav-link{display:flex;align-items:center;gap:6px;padding:12px 16px;font-size:0.78em;font-weight:600;color:var(--text2);text-decoration:none;white-space:nowrap;border-bottom:2px solid transparent;transition:all .2s}
.nav-link:hover{color:var(--text);background:rgba(99,102,241,0.06)}
.nav-link.active{color:var(--accent2);border-bottom-color:var(--accent)}
.nav-icon{font-size:1em}
.header{background:linear-gradient(135deg,#1e1b4b 0%,#312e81 50%,#1e1b4b 100%);padding:32px 24px 18px;text-align:center;border-bottom:2px solid var(--accent)}
.header h1{font-size:1.8em;font-weight:800;background:linear-gradient(135deg,#c7d2fe,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:4px}
.header p{color:var(--text2);font-size:0.88em}
.header .badge{display:inline-block;background:var(--accent);color:#fff;padding:2px 10px;border-radius:12px;font-size:0.72em;margin-top:6px}
.wrap{max-width:1400px;margin:0 auto;padding:16px 12px 60px}
.company-tabs{display:flex;gap:6px;margin:16px 0;flex-wrap:wrap}
.ctab{padding:10px 18px;background:var(--card);border:2px solid var(--border);border-radius:10px;cursor:pointer;font-weight:700;font-size:0.9em;transition:all .2s;color:var(--text2)}
.ctab:hover{border-color:var(--accent);color:var(--text)}
.ctab.active{border-color:var(--accent);background:rgba(99,102,241,0.15);color:var(--accent2)}
.ctab.compare{background:rgba(6,182,212,0.08);border-color:rgba(6,182,212,0.3);color:var(--cyan)}
.ctab.compare.active{background:rgba(6,182,212,0.2);border-color:var(--cyan)}
.sub-tabs{display:flex;gap:4px;margin:12px 0;flex-wrap:wrap}
.stab{padding:7px 14px;background:var(--card2);border:1px solid var(--border);border-radius:8px;cursor:pointer;font-size:0.78em;font-weight:600;color:var(--text2);transition:all .15s}
.stab.active{background:var(--accent);color:#fff;border-color:var(--accent)}
.panel{display:none}.panel.active{display:block;animation:fadeUp .3s ease}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.fy-note{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:10px 14px;margin:8px 0 16px;font-size:0.78em;color:var(--text2)}
.fy-note strong{color:var(--yellow)}
.table-scroll{overflow-x:auto;border-radius:10px;margin-bottom:16px}
table{width:100%;border-collapse:collapse;font-size:0.82em;min-width:700px}
thead th{background:var(--card2);color:var(--accent2);font-weight:700;padding:10px 12px;text-align:right;white-space:nowrap;border-bottom:2px solid var(--border)}
thead th:first-child{text-align:left;min-width:160px}
tbody td{padding:9px 12px;text-align:right;border-bottom:1px solid var(--border);white-space:nowrap}
tbody td:first-child{text-align:left;font-weight:600;color:var(--text)}
tbody tr:hover{background:rgba(99,102,241,0.06)}
tbody tr.hl{background:rgba(99,102,241,0.08)}
tbody tr.total-row{background:rgba(99,102,241,0.1);font-weight:700}
tbody tr.total-row td{border-top:2px solid var(--accent);color:var(--accent2)}
.up{color:var(--green)}.dn{color:var(--red)}
.chart-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin:16px 0}
.chart-box{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:16px}
.chart-box h3{font-size:0.85em;color:var(--accent2);margin-bottom:2px}
.chart-box canvas{max-height:280px}
.ch-desc{font-size:0.72em;color:var(--text2);margin-bottom:10px;font-weight:400}
.seg-insight{font-size:0.78em;color:var(--text2);padding:10px 14px;background:var(--card);border:1px solid var(--border);border-radius:8px;margin:8px 0;line-height:1.8}
.seg-insight strong{color:var(--cyan)}
.note{font-size:0.75em;color:var(--text2);margin:6px 0 16px;padding:10px 14px;background:var(--card);border-left:3px solid var(--accent);border-radius:0 8px 8px 0}
.seg-td-name{color:var(--cyan) !important}
.yoy{font-size:0.72em;display:block;margin-top:2px}
.yoy.up{color:var(--green)}.yoy.down{color:var(--red)}
@media(max-width:800px){.chart-grid{grid-template-columns:1fr}.ctab{padding:8px 12px;font-size:0.8em}}
</style>
</head>
<body>
<nav class="top-nav"><div class="top-nav-inner">
<span class="nav-brand">Stock Analyzer</span>
<a href="index.html" class="nav-link"><span class="nav-icon">&#9878;</span> 5단계 분석</a>
<a href="annual-financials.html" class="nav-link active"><span class="nav-icon">&#9650;</span> 종합 재무 데이터</a>
</div></nav>
<div class="header">
<h1>Big Tech 8 - 종합 재무 데이터</h1>
<p>AAPL / MSFT / GOOGL / AMZN / NVDA / META / TSLA / AMD | 연간·분기별·세그먼트 통합</p>
<span class="badge">Last Updated: Feb 2026</span>
</div>
<div class="wrap">
<div class="company-tabs" id="companyTabs"></div>
<div id="content"></div>
</div>
<script>
const D={
aapl:{name:'Apple',ticker:'AAPL',fy:'FY (10월~9월)',color:'#a2aaad',
labels:['FY2015','FY2016','FY2017','FY2018','FY2019','FY2020','FY2021','FY2022','FY2023','FY2024','FY2025'],
rev:[233715,215639,229234,265595,260174,274515,365817,394328,383285,391035,416161],
oi:[71230,60024,61344,70898,63930,66288,108949,119437,114301,123216,133050],
ni:[53394,45687,48351,59531,55256,57411,94680,99803,96995,93736,112010],
eps:[2.31,1.99,2.10,2.98,2.97,3.28,5.67,6.11,6.13,6.08,7.46],
ocf:[81266,65824,64225,77434,69391,80674,104038,122151,110543,118254,111482],
capex:[11247,12734,12795,13313,10495,7309,11085,10708,10959,9447,12715],
fcf:[70019,53090,51430,64121,58896,73365,92953,111443,99584,108807,98767],
rd:[8067,10045,11581,14236,16217,18752,21914,26251,29915,31370,34550],
bb:[35253,29722,32900,72738,66897,72358,85971,92527,95625,82981,100390],
note:'FY는 10월~9월. EPS는 4:1 분할(2020.8) 조정. FY2018부터 해외현금 송환으로 자사주매입 급증.'
},
msft:{name:'Microsoft',ticker:'MSFT',fy:'FY (7월~6월)',color:'#00a4ef',
labels:['FY2015','FY2016','FY2017','FY2018','FY2019','FY2020','FY2021','FY2022','FY2023','FY2024','FY2025'],
rev:[93580,91154,96571,110360,125843,143015,168088,198270,211915,245122,281724],
oi:[18161,26078,29025,35058,42959,52959,69916,83383,88523,109433,128528],
ni:[12193,20539,25489,16571,39240,44281,61271,72738,72361,88136,101832],
eps:[1.48,2.56,3.25,2.13,5.06,5.76,8.05,9.65,9.68,11.80,13.64],
ocf:[29080,33325,39507,43884,52185,60675,76740,89035,87582,118548,136162],
capex:[5944,8343,8129,11632,13925,15441,20622,23886,28107,44477,64551],
fcf:[23136,24982,31378,32252,38260,45234,56118,65149,59475,74071,71611],
rd:[12046,11988,13037,14726,16876,19269,20716,24512,27195,29510,32488],
bb:[14443,15969,11788,10721,19543,22968,27385,32696,22245,17254,18423],
note:'FY는 7월~6월. FY2015 OI에 Nokia 감손 $7.5B 포함. FY2018 NI에 TCJA 세금개혁 일회성 비용. FY2025 CapEx 급증(AI 인프라).'
},
googl:{name:'Alphabet',ticker:'GOOGL',fy:'캘린더 (1월~12월)',color:'#4285f4',
labels:['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'],
rev:[74989,90272,110855,136819,161857,182527,257637,282836,307394,350018,402836],
oi:[19360,23716,26178,27524,34231,41224,78714,74842,84293,112390,129039],
ni:[15826,19478,12662,30736,34343,40269,76033,59972,73795,100118,132170],
eps:[1.16,1.42,0.92,2.21,2.48,2.96,5.70,4.60,5.85,8.13,10.81],
ocf:[26572,36036,37091,47971,54520,65124,91652,91495,101746,125299,164713],
capex:[9915,9972,13184,25139,23548,22281,24640,31485,32251,52535,91447],
fcf:[16657,26064,23907,22832,30972,42843,67012,60010,69495,72764,73266],
rd:[12282,13948,16625,21419,26018,27573,31562,39500,45427,49326,61087],
bb:[1780,3693,4846,9075,18396,31149,50274,59296,61504,62222,45709],
note:'20:1 주식분할(2022.7). EPS 분할 소급 조정. 2017 NI는 TCJA 일회성 세금 비용. 2025 NI는 투자이익 포함.'
},
amzn:{name:'Amazon',ticker:'AMZN',fy:'캘린더 (1월~12월)',color:'#ff9900',
labels:['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'],
rev:[107006,135987,177866,232887,280522,386064,469822,513983,574785,637959,716924],
oi:[2233,4186,4106,12421,14541,22899,24879,12248,36852,68593,79975],
ni:[596,2371,3033,10073,11588,21331,33364,-2722,30425,59248,77670],
eps:[0.06,0.25,0.31,1.01,1.15,2.09,3.24,-0.27,2.90,5.53,7.17],
ocf:[12039,17203,18365,30723,38514,66064,46327,46752,84946,115877,139514],
capex:[4589,6737,10058,13427,16861,35044,55396,63645,52729,82999,131819],
fcf:[7450,10466,8307,17296,21653,31020,-9069,-16893,32217,32878,7695],
rd:[12540,16085,22620,28837,35931,42740,56052,73213,85622,88544,108521],
bb:[0,0,0,0,0,0,0,6000,0,0,0],
note:'20:1 주식분할(2022.6). R&D는 Technology &amp; Content. 2022 NI 적자는 Rivian 투자손실.'
},
nvda:{name:'NVIDIA',ticker:'NVDA',fy:'FY (2월~1월)',color:'#76b900',
labels:['FY16(~15)','FY17(~16)','FY18(~17)','FY19(~18)','FY20(~19)','FY21(~20)','FY22(~21)','FY23(~22)','FY24(~23)','FY25(~24)'],
rev:[5010,6910,9714,11716,10918,16675,26914,26974,60922,130497],
oi:[747,1934,3210,3804,2846,4532,10041,4224,32972,81453],
ni:[614,1666,3047,4141,2796,4332,9752,4368,29760,72880],
eps:[0.03,0.06,0.12,0.17,0.11,0.17,0.39,0.17,1.19,2.94],
ocf:[1191,1672,3502,3743,4761,5822,9108,5641,28090,64089],
capex:[86,176,593,600,489,1128,976,1833,1069,3236],
fcf:[1105,1496,2909,3143,4272,4694,8132,3808,27021,60853],
rd:[1331,1463,1797,2376,2829,3924,5268,7339,8675,12914],
bb:[587,739,909,1579,0,0,0,10039,9533,33706],
note:'FY는 2월~1월. EPS는 4:1(2021.7)+10:1(2024.7) 분할 반영. FY20/21 buyback=0은 Mellanox 인수.'
},
meta:{name:'Meta Platforms',ticker:'META',fy:'캘린더 (1월~12월)',color:'#1877f2',
labels:['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'],
rev:[17928,27638,40653,55838,70697,85965,117929,116609,134902,164501,200966],
oi:[6225,12427,20203,24913,23986,32671,46753,28944,46751,69380,83276],
ni:[3688,10188,15920,22112,18485,29146,39370,23200,39098,62360,60458],
eps:[1.29,3.49,5.39,7.57,6.43,10.09,13.77,8.59,14.87,23.86,23.49],
ocf:[8599,16108,24216,29274,36314,38747,57683,50475,71113,91328,115800],
capex:[2523,4491,6733,13915,15102,15115,18567,31431,27266,37256,72220],
fcf:[6076,11617,17483,15359,21212,23632,39116,19044,43847,54072,43585],
rd:[4816,5919,7754,10273,13600,18447,24655,35338,38483,43873,57372],
bb:[20,6,1976,12879,4202,6272,44537,27956,19774,30125,26248],
note:'2021.10 Facebook→Meta 사명변경. 2022 OI 급감은 Reality Labs 손실+구조조정. 2025 NI 감소는 세금 비용 증가.'
},
tsla:{name:'Tesla',ticker:'TSLA',fy:'캘린더 (1월~12월)',color:'#cc0000',
labels:['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'],
rev:[4046,7000,11759,21461,24578,31536,53823,81462,96773,97690,94827],
oi:[-717,-667,-1632,-253,80,1994,6523,13692,8891,7659,4355],
ni:[-889,-675,-1961,-976,-870,690,5519,12556,14997,7091,3794],
eps:[-0.46,-0.31,-0.79,-0.38,-0.33,0.21,1.63,3.62,4.30,2.04,1.08],
ocf:[-525,-124,-61,2098,2405,5943,11497,14724,13256,14923,14747],
capex:[1635,1440,4081,2320,1437,3242,6514,7163,8899,11342,8527],
fcf:[-2159,-1564,-4142,-222,968,2701,4983,7561,4357,3581,6220],
rd:[718,743,1378,1460,1343,1491,2593,3075,3969,4540,6411],
bb:[0,0,0,0,0,0,0,541,700,1241,2870],
note:'EPS는 5:1(2020.8)+3:1(2022.8) 분할 반영. 2015-2019 순손실. 2020년 첫 연간 흑자.'
},
amd:{name:'AMD',ticker:'AMD',fy:'캘린더 (1월~12월)',color:'#ed1c24',
labels:['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'],
rev:[3991,4319,5253,6475,6731,9763,16434,23601,22680,25785,34647],
oi:[-321,-470,75,451,571,1369,3648,1264,401,2086,3741],
ni:[-922,-497,-33,337,341,2490,3162,1320,854,1641,4335],
eps:[-0.84,-0.61,0.03,0.34,0.30,2.06,2.57,0.84,0.53,1.00,2.65],
ocf:[-226,90,12,34,493,1071,3521,3565,1667,3041,7709],
capex:[95,267,54,170,149,294,301,450,546,636,974],
fcf:[-314,-177,-42,-136,344,777,3220,3115,1121,2405,6735],
rd:[1547,1480,1547,1616,1703,1983,2845,5005,5872,6456,8091],
bb:[0,0,0,0,0,0,1590,4108,985,862,1316],
note:'2015-2016 순손실. 2020 NI에 $1.3B 이연법인세 환입 포함. 2022.2 Xilinx 인수 후 세그먼트 재편 및 무형자산 상각.'
}
};

const Q={
aapl:{l:['Q2 FY25','Q3 FY25','Q4 FY25','Q1 FY26'],rev:[95.4,94.0,102.5,143.8],ni:[24.8,23.4,27.5,42.1],eps:[1.65,1.57,1.85,2.84],ocf:[24.0,27.9,29.7,53.9],capex:[2.9,6.0,12.7,2.4],fcf:[21.1,21.9,17.0,51.6],rd:[8.6,8.9,8.9,10.9],bb:[25.0,21.1,20.0,25.0]},
msft:{l:['Q3 FY25','Q4 FY25','Q1 FY26','Q2 FY26'],rev:[70.1,76.4,77.7,81.3],ni:[25.8,27.2,27.7,38.5],eps:[3.46,3.65,3.72,5.16],ocf:[37.0,42.6,45.1,35.8],capex:[16.7,17.1,19.4,29.9],fcf:[20.3,25.6,25.7,5.9],rd:[8.2,8.6,8.1,8.5],bb:[4.8,4.5,5.7,7.4]},
googl:{l:['Q1 2025','Q2 2025','Q3 2025','Q4 2025'],rev:[90.2,96.5,102.3,113.8],ni:[34.5,28.2,35.0,34.5],eps:[2.81,2.31,2.87,2.82],ocf:[39.1,36.2,37.0,52.4],capex:[17.2,22.4,24.0,27.9],fcf:[24.8,19.0,13.1,24.5],rd:[13.6,13.9,15.2,15.4],bb:[15.1,13.6,11.5,5.5]},
amzn:{l:['Q1 2025','Q2 2025','Q3 2025','Q4 2025'],rev:[155.7,167.7,180.2,213.4],ni:[17.1,18.2,21.2,21.2],eps:[1.59,1.68,1.95,1.95],ocf:[31.9,36.6,35.5,35.5],capex:[25.0,32.2,35.1,39.5],fcf:[6.9,4.4,0.4,-4.0],rd:[24.7,25.5,29.0,29.4],bb:[0,0,0,0]},
nvda:{l:['Q4 FY25','Q1 FY26','Q2 FY26','Q3 FY26'],rev:[39.3,44.1,46.6,56.9],ni:[22.1,24.9,26.3,33.3],eps:[0.89,1.00,1.06,1.34],ocf:[16.6,18.5,19.2,24.5],capex:[1.3,1.5,1.8,2.2],fcf:[15.3,17.0,17.4,22.3],rd:[3.8,4.2,4.4,4.8],bb:[10.0,8.0,9.0,10.0]},
meta:{l:['Q1 2025','Q2 2025','Q3 2025','Q4 2025'],rev:[42.3,47.5,51.2,59.9],ni:[16.6,17.7,20.7,22.3],eps:[6.43,6.93,8.10,8.74],ocf:[22.4,24.3,26.5,32.0],capex:[13.4,14.5,15.0,16.5],fcf:[9.0,9.8,11.5,15.5],rd:[11.4,11.8,12.2,12.8],bb:[12.3,14.1,15.2,17.5]},
tsla:{l:['Q1 2025','Q2 2025','Q3 2025','Q4 2025'],rev:[19.3,22.5,28.1,24.9],ni:[0.4,1.2,1.4,0.8],eps:[0.12,0.33,0.39,0.24],ocf:[2.2,4.3,4.6,3.7],capex:[1.7,2.0,2.4,2.4],fcf:[0.4,2.3,2.2,1.3],rd:[1.2,1.3,1.4,1.5],bb:[0,0,0,0]},
amd:{l:['Q1 2025','Q2 2025','Q3 2025','Q4 2025'],rev:[7.4,7.7,9.3,10.3],ni:[0.7,0.9,1.2,1.5],eps:[0.44,0.54,0.75,0.92],ocf:[1.0,1.0,1.5,2.4],capex:[0.16,0.18,0.20,0.30],fcf:[0.9,0.8,1.3,2.1],rd:[1.7,1.8,1.8,1.9],bb:[0,0,0.6,1.3]}
};

const S={
aapl:{q:['FY2020','FY2021','FY2022','FY2023','FY2024','FY2025'],s:[
{n:'iPhone',v:[137781,191973,205489,200583,201183,209586],c:'#6366f1'},
{n:'Mac',v:[28622,35190,40177,29357,29984,33710],c:'#06b6d4'},
{n:'iPad',v:[23724,31862,29292,28300,26694,28020],c:'#22c55e'},
{n:'Wearables/Home/Acc',v:[30620,38367,41241,39845,37005,35690],c:'#f97316'},
{n:'Services',v:[53768,68425,78129,85200,96169,109155],c:'#ec4899'}
]},
msft:{q:['FY2020','FY2021','FY2022','FY2023','FY2024','FY2025'],s:[
{n:'Productivity &amp; Business',v:[46398,53915,63364,69274,77728,120810],c:'#6366f1'},
{n:'Intelligent Cloud',v:[48366,59728,74965,87907,105362,106265],c:'#06b6d4'},
{n:'Personal Computing',v:[48251,54445,59941,54734,62032,54649],c:'#f97316'}
]},
googl:{q:['2020','2021','2022','2023','2024','2025'],s:[
{n:'Google Search',v:[104062,149684,162450,175032,198117,224530],c:'#6366f1'},
{n:'YouTube Ads',v:[19772,28845,29243,31510,36152,40370],c:'#ec4899'},
{n:'Google Cloud',v:[13059,19206,26280,33088,43232,58710],c:'#06b6d4'},
{n:'Google Network',v:[23090,31701,32780,31312,30364,29790],c:'#f97316'},
{n:'Subs/Platforms/Devices',v:[21711,28032,29055,34688,40336,48030],c:'#22c55e'},
{n:'Other Bets',v:[657,753,1068,1527,1648,1537],c:'#9498b0'}
]},
amzn:{q:['2020','2021','2022','2023','2024','2025'],s:[
{n:'North America',v:[236282,279833,315880,352828,387497,426305],c:'#6366f1'},
{n:'International',v:[104412,127787,118007,131200,142906,161894],c:'#f97316'},
{n:'AWS',v:[45370,62202,80096,90757,107556,128725],c:'#06b6d4'}
]},
nvda:{q:['FY21(~20)','FY22(~21)','FY23(~22)','FY24(~23)','FY25(~24)'],s:[
{n:'Data Center',v:[6696,10613,15005,47525,115199],c:'#6366f1'},
{n:'Gaming',v:[7759,12462,9067,10447,11356],c:'#22c55e'},
{n:'Pro Visualization',v:[1053,2111,1544,1553,1881],c:'#f97316'},
{n:'Automotive',v:[536,566,903,1091,1692],c:'#06b6d4'},
{n:'OEM &amp; Other',v:[631,1162,455,306,389],c:'#9498b0'}
]},
meta:{q:['2021','2022','2023','2024','2025'],s:[
{n:'Family of Apps',v:[115655,114450,131948,162355,198759],c:'#6366f1'},
{n:'Reality Labs',v:[2274,2159,1896,2146,2207],c:'#ec4899'}
]},
tsla:{q:['2020','2021','2022','2023','2024','2025'],s:[
{n:'Automotive',v:[27236,47232,71462,82419,77071,69530],c:'#6366f1'},
{n:'Energy',v:[1994,2789,3909,6035,10092,12770],c:'#22c55e'},
{n:'Services &amp; Other',v:[2306,3802,6091,8319,10527,12527],c:'#f97316'}
]},
amd:{q:['2022','2023','2024','2025'],s:[
{n:'Data Center',v:[6043,6496,12579,16635],c:'#6366f1'},
{n:'Client',v:[6201,4651,7054,10640],c:'#06b6d4'},
{n:'Gaming',v:[6805,6212,2595,3910],c:'#22c55e'},
{n:'Embedded',v:[4552,5321,3557,3454],c:'#f97316'}
]}
};

const tickers=['aapl','msft','googl','amzn','nvda','meta','tsla','amd'];
let charts=[];
let curTicker='';

function init(){
const tabsEl=document.getElementById('companyTabs');
tickers.forEach(t=>{
const d=document.createElement('div');
d.className='ctab';d.textContent=D[t].ticker;
d.onclick=()=>showCompany(t);
tabsEl.appendChild(d);
});
const cmp=document.createElement('div');
cmp.className='ctab compare';cmp.textContent='8사 비교';
cmp.onclick=()=>showCompare();
tabsEl.appendChild(cmp);
showCompany('aapl');
}

function fmt(v){if(v===null||v===undefined)return'-';if(v<0)return'-$'+Math.abs(v).toLocaleString();return '$'+v.toLocaleString();}
function fmtE(v){if(v<0)return '-$'+Math.abs(v).toFixed(2);return '$'+v.toFixed(2);}
function fmtB(v){if(v<0)return '-$'+Math.abs(v).toFixed(1)+'B';return '$'+v.toFixed(1)+'B';}
function fmtM(v){return '$'+v.toLocaleString()+'M';}
function pct(a,b){if(!b||b===0)return'-';const p=((a-b)/Math.abs(b)*100);return (p>=0?'+':'')+p.toFixed(1)+'%';}

function showCompany(t){
curTicker=t;
document.querySelectorAll('.ctab').forEach(el=>el.classList.remove('active'));
document.querySelectorAll('.ctab')[tickers.indexOf(t)].classList.add('active');
charts.forEach(c=>c.destroy());charts=[];
const c=D[t],el=document.getElementById('content');
const last=c.rev.length-1;
const q=Q[t],s=S[t];
var h='';
h+='<div class="fy-note"><strong>'+c.name+' ('+c.ticker+')</strong> | 회계연도: '+c.fy+' | '+c.labels[0]+' ~ '+c.labels[last]+'</div>';
h+='<div class="sub-tabs">';
h+='<div class="stab active" onclick="showSub(0)">손익 요약</div>';
h+='<div class="stab" onclick="showSub(1)">현금흐름</div>';
h+='<div class="stab" onclick="showSub(2)">R&D &amp; Buybacks</div>';
h+='<div class="stab" onclick="showSub(3)">분기별 재무</div>';
h+='<div class="stab" onclick="showSub(4)">매출 세그먼트</div>';
h+='<div class="stab" onclick="showSub(5)">차트</div>';
h+='</div>';
// s0: 손익 요약
h+='<div class="panel active" id="s0">';
h+='<div class="table-scroll"><table><thead><tr><th>지표 ($M)</th>';
c.labels.forEach(function(l){h+='<th>'+l+'</th>';});
h+='<th>전체 성장</th></tr></thead><tbody>';
h+='<tr><td>매출</td>';c.rev.forEach(function(v){h+='<td>'+fmt(v)+'</td>';});h+='<td class="up">'+pct(c.rev[last],c.rev[0])+'</td></tr>';
h+='<tr><td>영업이익</td>';c.oi.forEach(function(v){h+='<td>'+(v<0?'<span class="dn">'+fmt(v)+'</span>':fmt(v))+'</td>';});h+='<td class="'+(c.oi[last]>c.oi[0]?'up':'dn')+'">'+pct(c.oi[last],c.oi[0])+'</td></tr>';
h+='<tr><td>순이익 (GAAP)</td>';c.ni.forEach(function(v){h+='<td>'+(v<0?'<span class="dn">'+fmt(v)+'</span>':fmt(v))+'</td>';});h+='<td class="'+(c.ni[last]>c.ni[0]?'up':'dn')+'">'+pct(c.ni[last],c.ni[0])+'</td></tr>';
h+='<tr><td>희석 EPS</td>';c.eps.forEach(function(v){h+='<td>'+fmtE(v)+'</td>';});h+='<td class="'+(c.eps[last]>c.eps[0]?'up':'dn')+'">'+pct(c.eps[last],c.eps[0])+'</td></tr>';
h+='<tr class="hl"><td>영업이익률</td>';c.rev.forEach(function(v,i){h+='<td>'+(c.oi[i]/v*100).toFixed(1)+'%</td>';});h+='<td></td></tr>';
h+='<tr class="hl"><td>순이익률</td>';c.rev.forEach(function(v,i){h+='<td>'+(c.ni[i]/v*100).toFixed(1)+'%</td>';});h+='<td></td></tr>';
h+='</tbody></table></div>';
if(c.note)h+='<div class="note">'+c.note+'</div>';
h+='</div>';
// s1: 현금흐름
h+='<div class="panel" id="s1">';
h+='<div class="table-scroll"><table><thead><tr><th>지표 ($M)</th>';
c.labels.forEach(function(l){h+='<th>'+l+'</th>';});
h+='</tr></thead><tbody>';
h+='<tr><td>영업현금흐름 (OCF)</td>';c.ocf.forEach(function(v){h+='<td>'+fmt(v)+'</td>';});h+='</tr>';
h+='<tr><td>설비투자 (CapEx)</td>';c.capex.forEach(function(v){h+='<td>'+fmt(v)+'</td>';});h+='</tr>';
h+='<tr><td>잉여현금흐름 (FCF)</td>';c.fcf.forEach(function(v){h+='<td>'+(v<0?'<span class="dn">'+fmt(v)+'</span>':fmt(v))+'</td>';});h+='</tr>';
h+='<tr class="hl"><td>FCF 마진</td>';c.rev.forEach(function(v,i){h+='<td>'+(c.fcf[i]/v*100).toFixed(1)+'%</td>';});h+='</tr>';
h+='<tr class="hl"><td>CapEx / 매출</td>';c.rev.forEach(function(v,i){h+='<td>'+(c.capex[i]/v*100).toFixed(1)+'%</td>';});h+='</tr>';
h+='</tbody></table></div></div>';
// s2: R&D & Buybacks
h+='<div class="panel" id="s2">';
h+='<div class="table-scroll"><table><thead><tr><th>지표 ($M)</th>';
c.labels.forEach(function(l){h+='<th>'+l+'</th>';});
h+='</tr></thead><tbody>';
h+='<tr><td>R&D 지출</td>';c.rd.forEach(function(v){h+='<td>'+fmt(v)+'</td>';});h+='</tr>';
h+='<tr><td>R&D / 매출</td>';c.rev.forEach(function(v,i){h+='<td>'+(c.rd[i]/v*100).toFixed(1)+'%</td>';});h+='</tr>';
h+='<tr><td>자사주매입</td>';c.bb.forEach(function(v){h+='<td>'+fmt(v)+'</td>';});h+='</tr>';
h+='<tr><td>Buyback / FCF</td>';c.fcf.forEach(function(v,i){if(v<=0||c.bb[i]===0)h+='<td>-</td>';else h+='<td>'+(c.bb[i]/v*100).toFixed(0)+'%</td>';});h+='</tr>';
h+='</tbody></table></div></div>';
// s3: 분기별 재무
h+='<div class="panel" id="s3">';
h+='<div class="table-scroll"><table><thead><tr><th>지표</th>';
q.l.forEach(function(l){h+='<th>'+l+'</th>';});
h+='</tr></thead><tbody>';
h+='<tr><td>매출 ($B)</td>';q.rev.forEach(function(v){h+='<td>'+fmtB(v)+'</td>';});h+='</tr>';
h+='<tr><td>순이익 ($B)</td>';q.ni.forEach(function(v){h+='<td>'+(v<0?'<span class="dn">'+fmtB(v)+'</span>':fmtB(v))+'</td>';});h+='</tr>';
h+='<tr><td>EPS</td>';q.eps.forEach(function(v){h+='<td>'+fmtE(v)+'</td>';});h+='</tr>';
h+='<tr><td>OCF ($B)</td>';q.ocf.forEach(function(v){h+='<td>'+fmtB(v)+'</td>';});h+='</tr>';
h+='<tr><td>CapEx ($B)</td>';q.capex.forEach(function(v){h+='<td>'+fmtB(v)+'</td>';});h+='</tr>';
h+='<tr><td>FCF ($B)</td>';q.fcf.forEach(function(v){h+='<td>'+(v<0?'<span class="dn">'+fmtB(v)+'</span>':fmtB(v))+'</td>';});h+='</tr>';
h+='<tr><td>R&D ($B)</td>';q.rd.forEach(function(v){h+='<td>'+fmtB(v)+'</td>';});h+='</tr>';
h+='<tr><td>자사주매입 ($B)</td>';q.bb.forEach(function(v){h+='<td>'+fmtB(v)+'</td>';});h+='</tr>';
h+='</tbody></table></div>';
h+='<div class="chart-grid">';
h+='<div class="chart-box"><h3>분기별 매출 &amp; 순이익 ($B)</h3><p class="ch-desc">3개월마다 번 돈과 남은 이익</p><canvas id="qch1"></canvas></div>';
h+='<div class="chart-box"><h3>분기별 EPS</h3><p class="ch-desc">3개월마다 주식 1주가 벌어다 준 이익</p><canvas id="qch2"></canvas></div>';
h+='<div class="chart-box"><h3>분기별 현금흐름 ($B)</h3><p class="ch-desc">3개월마다 실제 현금 흐름</p><canvas id="qch3"></canvas></div>';
h+='<div class="chart-box"><h3>분기별 R&amp;D &amp; Buybacks ($B)</h3><p class="ch-desc">연구개발비 vs 자사주매입(회사가 자기 주식 되사기)</p><canvas id="qch4"></canvas></div>';
h+='</div></div>';
// s4: 매출 세그먼트
h+='<div class="panel" id="s4">';
h+='<div class="chart-grid">';
h+='<div class="chart-box"><h3>사업부문별 연간 매출 추이</h3><p class="ch-desc">각 사업부문이 전체 매출에서 차지하는 비중</p><canvas id="sch1"></canvas></div>';
h+='<div class="chart-box"><h3>최근 연도 매출 비중</h3><p class="ch-desc">가장 최근 연도 기준, 어떤 사업이 가장 많이 버는지</p><canvas id="sch2"></canvas></div>';
h+='</div>';
var totals=s.q.map(function(_,qi){return s.s.reduce(function(sum,seg){return sum+seg.v[qi];},0);});
var lastIdx=s.q.length-1;
h+='<div class="table-scroll"><table><thead><tr><th>Segment</th>';
s.q.forEach(function(ql){h+='<th>'+ql+'</th>';});
h+='<th>성장률</th></tr></thead><tbody>';
s.s.forEach(function(seg){
var segGrowth=((seg.v[lastIdx]-seg.v[0])/Math.abs(seg.v[0])*100).toFixed(1);
var segGrowthCls=segGrowth>=0?'up':'dn';
h+='<tr><td class="seg-td-name">'+seg.n+'</td>';
seg.v.forEach(function(v,qi){
var qPct=(v/totals[qi]*100).toFixed(1);
h+='<td>'+fmtM(v)+'<span class="yoy" style="color:var(--text2)">'+qPct+'%</span></td>';
});
h+='<td class="'+segGrowthCls+'">'+(segGrowth>=0?'+':'')+segGrowth+'%</td></tr>';
});
h+='<tr class="total-row"><td>Total Revenue</td>';
totals.forEach(function(tt,i){
var yoy='';
if(i>0){var chg=((tt-totals[i-1])/totals[i-1]*100).toFixed(1);var cls=chg>=0?'up':'down';yoy='<span class="yoy '+cls+'">'+(chg>=0?'+':'')+chg+'% YoY</span>';}
h+='<td>'+fmtM(tt)+yoy+'</td>';
});
h+='<td></td></tr>';
h+='</tbody></table></div>';
// segment insights
var numYears=s.q.length-1;
h+='<div class="seg-insight">';
s.s.forEach(function(seg){
var growth=((seg.v[lastIdx]-seg.v[0])/seg.v[0]*100).toFixed(1);
var dir=growth>=0?'up':'down';
h+='<strong>'+seg.n+'</strong>: '+fmtM(seg.v[0])+' → '+fmtM(seg.v[lastIdx])+' (<span class="yoy '+dir+'" style="display:inline">'+(growth>=0?'+':'')+growth+'%</span> over '+numYears+'Y) &nbsp;|&nbsp; ';
});
h+='</div>';
h+='</div>';
// s5: 차트 (annual)
h+='<div class="panel" id="s5">';
h+='<div class="chart-grid">';
h+='<div class="chart-box"><h3>매출 &amp; 순이익 ($M)</h3><p class="ch-desc">회사가 번 총 금액과, 비용 다 빼고 남은 이익</p><canvas id="ch1"></canvas></div>';
h+='<div class="chart-box"><h3>EPS 추이</h3><p class="ch-desc">주식 1주당 벌어들인 이익 — 높을수록 좋아요</p><canvas id="ch2"></canvas></div>';
h+='<div class="chart-box"><h3>현금흐름 ($M)</h3><p class="ch-desc">실제 통장에 들어온 돈(OCF), 시설투자(CapEx), 자유롭게 쓸 수 있는 돈(FCF)</p><canvas id="ch3"></canvas></div>';
h+='<div class="chart-box"><h3>R&amp;D vs CapEx ($M)</h3><p class="ch-desc">새 기술 연구비(R&amp;D)와 공장/장비 투자비(CapEx) 비교</p><canvas id="ch4"></canvas></div>';
h+='</div></div>';
el.innerHTML=h;
}

function showSub(i){
document.querySelectorAll('.stab').forEach(function(s,idx){s.classList.toggle('active',idx===i);});
document.querySelectorAll('.panel').forEach(function(p,idx){p.classList.toggle('active',idx===i);});
if(i===3)setTimeout(function(){renderQCharts(curTicker);},50);
if(i===4)setTimeout(function(){renderSegCharts(curTicker);},50);
if(i===5)setTimeout(function(){renderCharts(curTicker);},50);
}

function renderCharts(t){
charts.forEach(function(c){c.destroy();});charts=[];
var c=D[t],clr=c.color,g='rgba(45,49,72,0.5)',tc='#9498b0';
var base={responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc,font:{size:10}},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return v>=1000?(v/1000).toFixed(0)+'B':'$'+v;}},grid:{color:g}}}};
charts.push(new Chart(document.getElementById('ch1'),{type:'bar',data:{labels:c.labels,datasets:[{label:'매출',data:c.rev,backgroundColor:clr+'99'},{label:'순이익',data:c.ni,backgroundColor:'rgba(34,197,94,0.7)'}]},options:base}));
charts.push(new Chart(document.getElementById('ch2'),{type:'line',data:{labels:c.labels,datasets:[{label:'EPS',data:c.eps,borderColor:clr,backgroundColor:clr+'22',fill:true,tension:0.3,pointRadius:5}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc,font:{size:10}},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return '$'+v;}},grid:{color:g}}}}}));
charts.push(new Chart(document.getElementById('ch3'),{type:'bar',data:{labels:c.labels,datasets:[{label:'OCF',data:c.ocf,backgroundColor:'rgba(99,102,241,0.7)'},{label:'CapEx',data:c.capex,backgroundColor:'rgba(239,68,68,0.7)'},{label:'FCF',data:c.fcf,backgroundColor:'rgba(34,197,94,0.7)'}]},options:base}));
charts.push(new Chart(document.getElementById('ch4'),{type:'bar',data:{labels:c.labels,datasets:[{label:'R&D',data:c.rd,backgroundColor:'rgba(6,182,212,0.7)'},{label:'CapEx',data:c.capex,backgroundColor:'rgba(249,115,22,0.7)'}]},options:base}));
}

function renderQCharts(t){
charts.forEach(function(c){c.destroy();});charts=[];
var q=Q[t],g='rgba(45,49,72,0.5)',tc='#9498b0';
var base={responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc,font:{size:10}},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return '$'+v.toFixed(1)+'B';}},grid:{color:g}}}};
charts.push(new Chart(document.getElementById('qch1'),{type:'bar',data:{labels:q.l,datasets:[{label:'매출',data:q.rev,backgroundColor:'rgba(99,102,241,0.7)',borderRadius:4},{label:'순이익',data:q.ni,backgroundColor:'rgba(34,197,94,0.7)',borderRadius:4}]},options:base}));
charts.push(new Chart(document.getElementById('qch2'),{type:'line',data:{labels:q.l,datasets:[{label:'EPS',data:q.eps,borderColor:'#818cf8',backgroundColor:'rgba(129,140,248,0.15)',fill:true,tension:0.3,pointRadius:5,pointBackgroundColor:'#818cf8'}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc,font:{size:10}},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return '$'+v;}},grid:{color:g}}}}}));
charts.push(new Chart(document.getElementById('qch3'),{type:'bar',data:{labels:q.l,datasets:[{label:'OCF',data:q.ocf,backgroundColor:'rgba(6,182,212,0.7)',borderRadius:4},{label:'CapEx',data:q.capex,backgroundColor:'rgba(239,68,68,0.7)',borderRadius:4},{label:'FCF',data:q.fcf,backgroundColor:'rgba(234,179,8,0.7)',borderRadius:4}]},options:base}));
charts.push(new Chart(document.getElementById('qch4'),{type:'bar',data:{labels:q.l,datasets:[{label:'R&D',data:q.rd,backgroundColor:'rgba(249,115,22,0.7)',borderRadius:4},{label:'Buybacks',data:q.bb,backgroundColor:'rgba(236,72,153,0.7)',borderRadius:4}]},options:base}));
}

function renderSegCharts(t){
charts.forEach(function(c){c.destroy();});charts=[];
var s=S[t],tc='#9498b0',g='rgba(45,49,72,0.5)';
var labels=s.q;
var lastIdx=s.q.length-1;
var barDs=s.s.map(function(seg){return{label:seg.n,data:seg.v,backgroundColor:seg.c+'cc',borderColor:seg.c,borderWidth:1};});
charts.push(new Chart(document.getElementById('sch1'),{type:'bar',data:{labels:labels,datasets:barDs},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{color:tc,font:{size:10},boxWidth:12}},tooltip:{callbacks:{label:function(ctx){return ctx.dataset.label+': $'+ctx.raw.toLocaleString()+'M';}}}},scales:{x:{stacked:true,ticks:{color:tc,font:{size:10}},grid:{color:g}},y:{stacked:true,ticks:{color:tc,font:{size:10},callback:function(v){return v>=1000?'$'+(v/1000).toFixed(1)+'B':'$'+v+'M';}},grid:{color:g}}}}}));
var lastVals=s.s.map(function(seg){return seg.v[lastIdx];});
charts.push(new Chart(document.getElementById('sch2'),{type:'doughnut',data:{labels:s.s.map(function(seg){return seg.n;}),datasets:[{data:lastVals,backgroundColor:s.s.map(function(seg){return seg.c+'cc';}),borderColor:s.s.map(function(seg){return seg.c;}),borderWidth:2}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom',labels:{color:tc,font:{size:10},boxWidth:12}},tooltip:{callbacks:{label:function(ctx){var total=ctx.dataset.data.reduce(function(a,b){return a+b;},0);var pctV=((ctx.raw/total)*100).toFixed(1);return ctx.label+': $'+ctx.raw.toLocaleString()+'M ('+pctV+'%)';}}}}}}));
}

function showCompare(){
document.querySelectorAll('.ctab').forEach(function(el){el.classList.remove('active');});
document.querySelector('.ctab.compare').classList.add('active');
charts.forEach(function(c){c.destroy();});charts=[];
var el=document.getElementById('content');
var yrs=['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'];
var align={aapl:[0,1,2,3,4,5,6,7,8,9,10],msft:[0,1,2,3,4,5,6,7,8,9,10],googl:[0,1,2,3,4,5,6,7,8,9,10],amzn:[0,1,2,3,4,5,6,7,8,9,10],nvda:[0,1,2,3,4,5,6,7,8,9,null],meta:[0,1,2,3,4,5,6,7,8,9,10],tsla:[0,1,2,3,4,5,6,7,8,9,10],amd:[0,1,2,3,4,5,6,7,8,9,10]};
function getVal(t,field,yi){var idx=align[t][yi];if(idx===null)return null;return D[t][field][idx];}
var revRows='',niRows='',epsRows='',fcfRows='';
tickers.forEach(function(t){
var c=D[t];
revRows+='<tr><td style="color:'+c.color+';font-weight:700">'+c.ticker+'</td>';
yrs.forEach(function(_,i){var v=getVal(t,'rev',i);revRows+='<td>'+(v!==null?fmt(v):'-')+'</td>';});
revRows+='</tr>';
niRows+='<tr><td style="color:'+c.color+';font-weight:700">'+c.ticker+'</td>';
yrs.forEach(function(_,i){var v=getVal(t,'ni',i);niRows+='<td>'+(v!==null?(v<0?'<span class="dn">'+fmt(v)+'</span>':fmt(v)):'-')+'</td>';});
niRows+='</tr>';
epsRows+='<tr><td style="color:'+c.color+';font-weight:700">'+c.ticker+'</td>';
yrs.forEach(function(_,i){var v=getVal(t,'eps',i);epsRows+='<td>'+(v!==null?fmtE(v):'-')+'</td>';});
epsRows+='</tr>';
fcfRows+='<tr><td style="color:'+c.color+';font-weight:700">'+c.ticker+'</td>';
yrs.forEach(function(_,i){var v=getVal(t,'fcf',i);fcfRows+='<td>'+(v!==null?(v<0?'<span class="dn">'+fmt(v)+'</span>':fmt(v)):'-')+'</td>';});
fcfRows+='</tr>';
});
var h='';
h+='<div class="fy-note"><strong>8사 비교 (10년)</strong> | 캘린더 연도 기준 정렬 (2015~2025). AAPL(9월결산), MSFT(6월결산), NVDA(1월결산)는 가장 가까운 캘린더 연도에 매핑. NVDA FY2026 미발표로 2025 데이터 없음.</div>';
h+='<div class="sub-tabs">';
h+='<div class="stab active" onclick="showCmpSub(0)">매출 비교</div>';
h+='<div class="stab" onclick="showCmpSub(1)">순이익 비교</div>';
h+='<div class="stab" onclick="showCmpSub(2)">EPS 비교</div>';
h+='<div class="stab" onclick="showCmpSub(3)">FCF 비교</div>';
h+='<div class="stab" onclick="showCmpSub(4)">비교 차트</div>';
h+='</div>';
var thYrs='';yrs.forEach(function(y){thYrs+='<th>'+y+'</th>';});
h+='<div class="panel active" id="s0"><div class="table-scroll"><table><thead><tr><th>Ticker</th>'+thYrs+'</tr></thead><tbody>'+revRows+'</tbody></table></div></div>';
h+='<div class="panel" id="s1"><div class="table-scroll"><table><thead><tr><th>Ticker</th>'+thYrs+'</tr></thead><tbody>'+niRows+'</tbody></table></div></div>';
h+='<div class="panel" id="s2"><div class="table-scroll"><table><thead><tr><th>Ticker</th>'+thYrs+'</tr></thead><tbody>'+epsRows+'</tbody></table></div></div>';
h+='<div class="panel" id="s3"><div class="table-scroll"><table><thead><tr><th>Ticker</th>'+thYrs+'</tr></thead><tbody>'+fcfRows+'</tbody></table></div></div>';
h+='<div class="panel" id="s4">';
h+='<div class="chart-grid">';
h+='<div class="chart-box"><h3>매출 비교 ($B)</h3><p class="ch-desc">8개 회사가 각각 1년에 얼마나 벌었는지</p><canvas id="cmpRev"></canvas></div>';
h+='<div class="chart-box"><h3>영업이익률 비교</h3><p class="ch-desc">매출 100원 중 이익이 몇 원인지 (효율성)</p><canvas id="cmpMargin"></canvas></div>';
h+='<div class="chart-box"><h3>순이익 비교 ($B)</h3><p class="ch-desc">비용 다 빼고 진짜 남은 돈 비교</p><canvas id="cmpNi"></canvas></div>';
h+='<div class="chart-box"><h3>CapEx 비교 ($B)</h3><p class="ch-desc">공장/서버/장비에 투자한 금액 비교</p><canvas id="cmpCapex"></canvas></div>';
h+='</div></div>';
el.innerHTML=h;
}

function showCmpSub(i){
document.querySelectorAll('.stab').forEach(function(s,idx){s.classList.toggle('active',idx===i);});
document.querySelectorAll('.panel').forEach(function(p,idx){p.classList.toggle('active',idx===i);});
if(i===4)setTimeout(renderCmpCharts,50);
}

function renderCmpCharts(){
charts.forEach(function(c){c.destroy();});charts=[];
var yrs=['2015','2016','2017','2018','2019','2020','2021','2022','2023','2024','2025'];
var g='rgba(45,49,72,0.5)',tc='#9498b0';
var align={aapl:[0,1,2,3,4,5,6,7,8,9,10],msft:[0,1,2,3,4,5,6,7,8,9,10],googl:[0,1,2,3,4,5,6,7,8,9,10],amzn:[0,1,2,3,4,5,6,7,8,9,10],nvda:[0,1,2,3,4,5,6,7,8,9,null],meta:[0,1,2,3,4,5,6,7,8,9,10],tsla:[0,1,2,3,4,5,6,7,8,9,10],amd:[0,1,2,3,4,5,6,7,8,9,10]};
function getData(t,f){return yrs.map(function(_,i){var idx=align[t][i];if(idx===null)return null;return D[t][f][idx];});}
function getMargin(t){return yrs.map(function(_,i){var idx=align[t][i];if(idx===null)return null;return+(D[t].oi[idx]/D[t].rev[idx]*100).toFixed(1);});}
var sets=tickers.map(function(t){return{label:D[t].ticker,data:getData(t,'rev').map(function(v){return v?+(v/1000).toFixed(1):null;}),borderColor:D[t].color,backgroundColor:D[t].color+'22',tension:0.3,pointRadius:4,borderWidth:2,spanGaps:true};});
var base={responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return '$'+v+'B';}},grid:{color:g}}}};
charts.push(new Chart(document.getElementById('cmpRev'),{type:'line',data:{labels:yrs,datasets:sets},options:base}));
var mSets=tickers.map(function(t){return{label:D[t].ticker,data:getMargin(t),borderColor:D[t].color,tension:0.3,pointRadius:3,borderWidth:2,spanGaps:true};});
charts.push(new Chart(document.getElementById('cmpMargin'),{type:'line',data:{labels:yrs,datasets:mSets},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:tc,font:{size:10}}}},scales:{x:{ticks:{color:tc},grid:{color:g}},y:{ticks:{color:tc,callback:function(v){return v+'%';}},grid:{color:g}}}}}));
var niSets=tickers.map(function(t){return{label:D[t].ticker,data:getData(t,'ni').map(function(v){return v!==null?+(v/1000).toFixed(1):null;}),borderColor:D[t].color,tension:0.3,pointRadius:3,borderWidth:2,spanGaps:true};});
charts.push(new Chart(document.getElementById('cmpNi'),{type:'line',data:{labels:yrs,datasets:niSets},options:base}));
var cxSets=tickers.map(function(t){return{label:D[t].ticker,data:getData(t,'capex').map(function(v){return v!==null?+(v/1000).toFixed(1):null;}),borderColor:D[t].color,tension:0.3,pointRadius:3,borderWidth:2,spanGaps:true};});
charts.push(new Chart(document.getElementById('cmpCapex'),{type:'line',data:{labels:yrs,datasets:cxSets},options:base}));
}

init();
</script>
</body>
</html>